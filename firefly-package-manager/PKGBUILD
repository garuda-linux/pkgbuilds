# Maintainer: TNE <tne@garudalinux.org>

pkgname=firefly-package-manager
pkgver="0.8.1"
_commit='5c286d1aad12b7d398ecd031c6f4ca3c8503120c'
pkgrel=1
pkgdesc="Garuda Linux GUI package manager"
arch=('x86_64')
url="https://gitlab.com/garuda-linux/applications/$pkgname"
license=('GPL')
depends=('qt6-base' 'pacman' 'pacman-contrib' 'garuda-update' 'gawk' 'archlinux-appstream-data' 'appstream-qt')
makedepends=('qt6-tools' 'cmake' 'git')
source=("https://gitlab.com/garuda-linux/applications/firefly/-/archive/${_commit}/firefly-${_commit}.tar.gz")
sha256sums=('SKIP')

build() {
  cmake -B build -S "firefly-$_commit" \
    -DCMAKE_BUILD_TYPE='Release' \
    -DCMAKE_INSTALL_PREFIX='/usr' \
    -Wno-dev
  make -C build
}

package() {
  make -C build DESTDIR="$pkgdir" install

  cd "firefly-$_commit" || exit
  install -Dm0644 firefly.desktop "$pkgdir/etc/xdg/autostart/firefly.desktop"
}
