# Maintainer: TNE <tne [at] garudalinux (dot) org>

pkgname=garuda-config-agent
pkgdesc="Applies and manages system configuration changes"
pkgver=0.1.2
pkgrel=1
arch=('any')
license=('GPL-3.0-or-later')
source=("garuda-config-agent.py"
        "garuda-config-agent-pre.hook"
        "garuda-config-agent-post.hook"
        "garuda-config-agent-postinst.hook")
sha512sums=('6aaefb6284d59700987a04da48a5e2f81589e9ca82a475ea82c6c1d186128b9bb3d7855fba8c171c29b9ba146fabeeb2d23651a3e7d410f81d95a4bf21073c14'
            '977ca967bb59da7b83c97de6fc93701207dc3e54471f0ce047e98d93f12103244a92c481dcbd2a8425fb993023b4595da51145a6c2ef0cbe298124b452053c90'
            'a285b5a2c7ede2105e6b509a91221602e117e03991b3c08407ee5ff526769687549b02b05be02a70f55db0d68cb59a75ba885dcb6b7f9bf2508f2da4a0ab1452'
            'f8dba371b75e4e2e4432a8e53a938cb9bd115739c37e6ec2cab45dde4dfe1552a11e3b126d0cb010f8ad17fea10444a2ede4bf9b18c28faa0ca3a837a8238766')

package() {
  depends=('python' 'sqlite' 'python-yaml')

  cd "$srcdir" || exit
  install -d "$pkgdir"/usr/share/libalpm/hooks
  install -Dm644 garuda-config-agent-pre.hook "$pkgdir"/usr/share/libalpm/hooks/50-garuda-config-agent-pre.hook
  install -Dm644 garuda-config-agent-post.hook "$pkgdir"/usr/share/libalpm/hooks/000-garuda-config-agent-post.hook
  install -Dm644 garuda-config-agent-postinst.hook "$pkgdir"/usr/share/libalpm/hooks/000-garuda-config-agent-postinst.hook

  install -Dm755 garuda-config-agent.py "$pkgdir"/usr/share/libalpm/scripts/garuda-config-agent
  mkdir -p "$pkgdir"/etc/garuda/garuda-config-agent
}
