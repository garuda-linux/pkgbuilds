# Maintainer: TNE <tne [at] garudalinux (dot) org>

pkgname=garuda-config-agent
pkgdesc="Applies and manages system configuration changes"
pkgver=0.1.1
pkgrel=2
arch=('any')
license=('GPL-3.0-or-later')
source=("garuda-config-agent.py"
        "garuda-config-agent-pre.hook"
        "garuda-config-agent-post.hook"
        "garuda-config-agent-postinst.hook")
sha512sums=('26a5f7b168c37efc6464dd94b23971339c16184f300ea7b1b6f2226e1fb7ad82e80b454939a962e2ca689e0ad837f1f6e618acd0f0815a003f8b96e01e26328d'
            '977ca967bb59da7b83c97de6fc93701207dc3e54471f0ce047e98d93f12103244a92c481dcbd2a8425fb993023b4595da51145a6c2ef0cbe298124b452053c90'
            'a285b5a2c7ede2105e6b509a91221602e117e03991b3c08407ee5ff526769687549b02b05be02a70f55db0d68cb59a75ba885dcb6b7f9bf2508f2da4a0ab1452'
            'f8dba371b75e4e2e4432a8e53a938cb9bd115739c37e6ec2cab45dde4dfe1552a11e3b126d0cb010f8ad17fea10444a2ede4bf9b18c28faa0ca3a837a8238766')

package() {
  depends=('python' 'sqlite' 'python-yaml')

  cd "$srcdir" || exit
  install -d "$pkgdir"/usr/share/libalpm/hooks
  install -Dm644 garuda-config-agent-pre.hook "$pkgdir"/usr/share/libalpm/hooks/50-garuda-config-agent-pre.hook
  install -Dm644 garuda-config-agent-post.hook "$pkgdir"/usr/share/libalpm/hooks/000-garuda-config-agent-post.hook
  install -Dm644 garuda-config-agent-postinst.hook "$pkgdir"/usr/share/libalpm/hooks/000-garuda-config-agent-postinst.hook

  install -Dm755 garuda-config-agent.py "$pkgdir"/usr/share/libalpm/scripts/garuda-config-agent
  mkdir -p "$pkgdir"/etc/garuda/garuda-config-agent
}
